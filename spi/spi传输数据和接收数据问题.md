# spi传输数据和接收数据问题

1. 当然要发送了。具体看接的设备的协议即可。如果2边都是单片机，则需要自己定一个协议。

2. 是要自己定协议的，两边都是单片机，主机向从机发出一个查询指令后只能不停地读从机，直到收到从机返回的有效数据，而从机是不能主动把结果发给主机的，是么？
   如果是这样的话那即使在没有数据传输的情况下主机也要不停地收发数据啊  

   http://www.dzsc.com/dzbbs/20061204/200765193421750618.html

## 优点

1. 这样传输的特点:这样的传输方式有一个优点，与普通的串行通讯不同，普通的串行通讯一次连续传送至少8位数据，而SPI允许数据一位一位的传送，甚至允许暂停，因为SCLK时钟线由主控设备控制，当没有时钟跳变时，从设备不采集或传送数据。
2. SPI还是一个数据交换协议:因为SPI的数据输入和输出线独立，所以允许同时完成数据的输入和输出。
3. 支持全双工操作。

## 缺点

1. 需要占用主机较多的口线（每个从机都需要一根片选线）；
2. 只支持单个主机；
3. 没有指定的流控制，没有应答机制确认是否接收到数据。

# 解决方法

思来想去，这里忽略了两个问题：

1. 时钟线。
2. 片选线。

因此，这里做一个简单的思路整理，尝试是否能以以下的思路，达成spi在进行数据交换的时候，能让主机筛选从机的数据，以及从机筛选主机的数据：

1. 首先，我们从主从连接的角度，此时，SCLK和SS由主机发出，且从机只能被动接收。

2. 在主机角度，我们可以让主机在想要接收数据和发送数据的时候，先发送时钟信号，也就是说，主机在进行通信不发送SCLK和SS。在从机角度，此时什么都做不了。

3. 在主机角度，当我想要发送或者接收数据的时候，我发送一段时间的SCLK（比如说8个SCLK上升沿），通过这个步骤：

   1. 同步主从的时钟动作；
   2. 向从机表达，我想传送或者接收数据；
   3. 在这个时候，如果想传送数据，那么就准备好传送的数据。

   在从机角度，此时主机发来了SCLK：

   1. 同步时钟；
   2. 如果有要传送出去的数据，那么就准备好传送的数据。

4. 直到发送一段时间的SCLK之后，我们就使SS置1，此时开始通信。我认为，每传送完8位（这次设计是8位）就要有一个时间间隔，来让主从双方加载下一byte的数据。此时SS置0，当再次置1再传送。

5. 那如果传送了无用的数据怎么办，我认为如果是两个单片机，应该是以某一个特定的数据为开头和结尾传送给对方，作为识别。

